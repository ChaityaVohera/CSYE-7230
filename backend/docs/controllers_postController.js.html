<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: controllers/postController.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: controllers/postController.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// controllers/postController.js
const Post = require("../models/postModel");

/**
 * Create a new post.
 * @route POST /api/post/create
 * @access Protected
 * @param {Object} req - Express request object containing `title`, `text`, and `userId` in the body.
 * @param {Object} res - Express response object.
 * @returns {Object} - Success message and the created post object.
 */
const createPost = async (req, res) => {
  try {
    const { title, text, userId } = req.body;

    // Validate data
    if (!title || !text || !userId) {
      return res.status(400).json({ error: "All fields are required" });
    }

    // Create the post
    const newPost = new Post({
      title,
      text,
      userId,
    });

    // Save the post to the database
    await newPost.save();

    // Respond with the created post
    res
      .status(201)
      .json({ message: "Post created successfully", post: newPost });
  } catch (error) {
    console.error("Error creating post:", error);
    res
      .status(500)
      .json({ error: "An error occurred while creating the post." });
  }
};

/**
 * Get all posts across the user's network.
 * @route GET /api/post/network
 * @access Protected
 * @param {Object} req - Express request object (auth handled by frontend).
 * @param {Object} res - Express response object.
 * @returns {Object} - List of all posts (frontend will filter based on user session).
 */
const getNetworkPosts = async (req, res) => {
  try {
    // The frontend will verify authentication before making the request
    // Backend simply returns all posts
    const allPosts = await Post.find()
      .populate("authorId", "userName bio pic")
      .sort({ createdAt: -1 });

    console.log(allPosts);

    res.status(200).json({
      success: true,
      data: allPosts, // Let frontend filter based on session storage
    });
  } catch (error) {
    console.error("Feed error:", error);
    res.status(500).json({
      success: false,
      message: "Failed to load posts",
    });
  }
};

module.exports = { createPost, getNetworkPosts };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-middleware_authMiddleware.html">middleware/authMiddleware</a></li><li><a href="module-middleware_errorMiddleware.html">middleware/errorMiddleware</a></li><li><a href="module-routes_chatRoutes.html">routes/chatRoutes</a></li><li><a href="module-routes_messageRoutes.html">routes/messageRoutes</a></li><li><a href="module-routes_postRoute.html">routes/postRoute</a></li><li><a href="module-routes_userRoutes.html">routes/userRoutes</a></li></ul><h3>Global</h3><ul><li><a href="global.html#accessChat">accessChat</a></li><li><a href="global.html#addToGroup">addToGroup</a></li><li><a href="global.html#allMessages">allMessages</a></li><li><a href="global.html#allUsers">allUsers</a></li><li><a href="global.html#authUser">authUser</a></li><li><a href="global.html#createGroupChat">createGroupChat</a></li><li><a href="global.html#createPost">createPost</a></li><li><a href="global.html#fetchChats">fetchChats</a></li><li><a href="global.html#getNetworkPosts">getNetworkPosts</a></li><li><a href="global.html#matchPassword">matchPassword</a></li><li><a href="global.html#registerUser">registerUser</a></li><li><a href="global.html#removeFromGroup">removeFromGroup</a></li><li><a href="global.html#renameGroup">renameGroup</a></li><li><a href="global.html#sendMessage">sendMessage</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sat Apr 05 2025 11:48:54 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
